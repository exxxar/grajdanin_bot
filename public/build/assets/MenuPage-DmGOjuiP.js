import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as n,b as t,F as m,e as y,d as p,t as f,w as d,v as b,g as R,L as D,J as E,K as z,M as H,i as v,a as k,f as O,k as $,n as P,r as N,j as x,N as _,l as U}from"./app-oamH8Y-J.js";import{m as c}from"./makeAxiosFactory-BxhBoIlf.js";import{u as I}from"./users-Cz27-HQ6.js";import{u as J}from"./baseExports-C1Wimd_G.js";const X={methods:{goTo(l){this.$router.push({name:l})}}},K={class:"btn-group-vertical w-100",role:"group","aria-label":"Вертикальное меню действий"};function Q(l,e,o,u,s,a){return n(),i("div",K,[t("button",{type:"button",onClick:e[0]||(e[0]=r=>a.goTo("MunicipalityPage")),class:"btn btn-outline-primary p-3"},"Список муниципалитетов"),t("button",{type:"button",onClick:e[1]||(e[1]=r=>a.goTo("HelpsPage")),class:"btn btn-outline-primary p-3"},"Список видов помощи"),t("button",{type:"button",onClick:e[2]||(e[2]=r=>a.goTo("IssuesPage")),class:"btn btn-outline-primary p-3"},"Список ситуаций"),t("button",{type:"button",onClick:e[3]||(e[3]=r=>a.goTo("UserPage")),class:"btn btn-outline-primary p-3"},"Список пользователей "),t("button",{type:"button",onClick:e[4]||(e[4]=r=>a.goTo("ReportPage")),class:"btn btn-outline-primary p-3"},"Список заявок")])}const Y=S(X,[["render",Q]]),Z={name:"IssueSelector",props:{issues:{type:Array,required:!0},modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],watch:{problems:{deep:!0,handler(l){this.$emit("update:modelValue",l)}}},data(){return{selected:null,problems:[]}},mounted(){this.modelValue&&(this.problems=JSON.parse(JSON.stringify(this.modelValue||{})))},methods:{selectIssueCategory(l){this.selected=null,this.$nextTick(()=>{this.selected=l})},removeIssue(l){this.problems[0].splice(l,1)},addAnotherProblem(){this.problems[0]?this.problems[0].push(""):this.problems[0]=[]},toggleIssue(l){const e=this.selected.id;this.problems[e]||(this.problems[e]=[]);const o=this.problems[e].indexOf(l);o!==-1?this.problems[e].splice(o,1):this.problems[e].push(l),this.problems[e].length===0&&delete this.problems[e]}}},ee={class:"row row-cols-2"},te={class:"col mb-0 mt-0"},oe=["onClick"],se={class:"card-body d-flex flex-column justify-content-center align-items-center p-1"},le=["innerHTML"],re=["innerHTML"],ne={key:0,class:"badge bg-warning",style:{position:"absolute",top:"0px",right:"0px","font-size":"14px"}},ie={class:"col mb-0 mt-0"},ae={class:"card-body d-flex flex-column justify-content-center align-items-center p-1"},de={key:0,class:"badge bg-warning",style:{position:"absolute",top:"0px",right:"0px","font-size":"14px"}},me={class:"modal fade",id:"choose-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ue={class:"modal-dialog"},pe={class:"modal-content"},fe={class:"modal-body"},be={class:"list-group"},ge=["onClick"],ye={key:0},ce={key:0,class:"alert alert-light text-primary mb-2 fw-bold"},he={class:"input-group mb-2"},ve={class:"form-floating"},ke=["onUpdate:modelValue","id"],Se=["for"],we={class:"input-group-text",id:"basic-addon1"},Ve=["onClick"],$e=["disabled"];function Ue(l,e,o,u,s,a){var r,g,V;return n(),i(m,null,[t("div",ee,[(n(!0),i(m,null,y(o.issues,h=>{var w,T;return n(),i("div",te,[t("div",{"data-bs-toggle":"modal","data-bs-target":"#choose-modal",onClick:al=>a.selectIssueCategory(h),style:{"min-height":"120px"},class:"card mb-2 border-light-subtle shadow-sm"},[t("div",se,[t("div",{style:{"font-size":"36px"},innerHTML:h.icon},null,8,le),t("div",{class:"text-center fw-bold",style:{"line-height":"120%","font-size":"12px"},innerHTML:h.name},null,8,re),(((w=s.problems[h.id])==null?void 0:w.length)||0)>0?(n(),i("span",ne,f(((T=s.problems[h.id])==null?void 0:T.length)||0),1)):p("",!0)])],8,oe)])}),256)),t("div",ie,[t("div",{"data-bs-toggle":"modal","data-bs-target":"#choose-modal",onClick:e[0]||(e[0]=h=>a.selectIssueCategory(null)),style:{"min-height":"120px"},class:"card mb-2 border-warning shadow-sm"},[t("div",ae,[e[3]||(e[3]=t("div",{style:{"font-size":"36px"}},[t("i",{class:"fa-solid fa-circle-question text-warning"})],-1)),e[4]||(e[4]=t("div",{class:"text-center fw-bold text-warning",style:{"line-height":"120%","font-size":"12px"}},"Другое ",-1)),(((r=s.problems[0])==null?void 0:r.length)||0)>0?(n(),i("span",de,f(((g=s.problems[0])==null?void 0:g.length)||0),1)):p("",!0)])])])]),t("div",me,[t("div",ue,[t("div",pe,[e[7]||(e[7]=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Окно выбора"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",fe,[s.selected?(n(),i(m,{key:0},[t("ul",be,[(n(!0),i(m,null,y(JSON.parse((V=s.selected)==null?void 0:V.variants),h=>(n(),i("li",{onClick:w=>a.toggleIssue(h),class:"list-group-item p-3 fw-bold d-flex justify-content-between","aria-current":"true"},[t("span",null,f(h),1),(s.problems[s.selected.id]||[]).includes(h)?(n(),i("span",ye,[...e[5]||(e[5]=[t("i",{class:"fa fa-check text-primary"},null,-1)])])):p("",!0)],8,ge))),256))]),t("button",{type:"button",onClick:e[1]||(e[1]=h=>s.problems[s.selected.id]=[]),class:"btn btn-outline-light p-3 mt-2 text-primary w-100"},"Очистить ")],64)):(n(),i(m,{key:1},[(s.problems[0]||[]).length===0?(n(),i("p",ce," Вы еще ничего не добавили ")):p("",!0),(n(!0),i(m,null,y(s.problems[0]||[],(h,w)=>(n(),i("div",he,[t("div",ve,[d(t("input",{type:"text","onUpdate:modelValue":T=>s.problems[0][w]=T,class:"form-control",id:"issue-custom-input-"+w,placeholder:"Проблема"},null,8,ke),[[b,s.problems[0][w]]]),t("label",{for:"issue-custom-input-"+w},"Введите текст #"+f(w),9,Se)]),t("span",we,[t("button",{type:"button",class:"btn btn-link ml-2 text-danger",onClick:T=>a.removeIssue(w)},[...e[6]||(e[6]=[t("i",{class:"fas fa-trash"},null,-1)])],8,Ve)])]))),256)),t("button",{type:"button",disabled:(s.problems[0]||[]).length>=10,onClick:e[2]||(e[2]=(...h)=>a.addAnotherProblem&&a.addAnotherProblem(...h)),class:"btn btn-outline-light p-3 mt-2 text-primary w-100"},"Добавить еще ",8,$e)],64))]),e[8]||(e[8]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary p-3 w-100","data-bs-dismiss":"modal"},"Продолжить ")],-1))])])])],64)}const L=S(Z,[["render",Ue]]),Re={name:"AudioRecorder",props:{modelValue:{type:Array,default:()=>[]},maxFiles:{type:Number,default:10}},data(){return{mediaRecorder:null,chunks:[],isRecording:!1}},computed:{audios(){return this.modelValue}},methods:{async startRecording(){if(this.isRecording)return;const l=await navigator.mediaDevices.getUserMedia({audio:!0});this.mediaRecorder=new MediaRecorder(l),this.chunks=[],this.isRecording=!0,this.mediaRecorder.ondataavailable=e=>{this.chunks.push(e.data)},this.mediaRecorder.onstop=()=>{const e=new Blob(this.chunks,{type:"audio/webm"}),o=URL.createObjectURL(e),u=[...this.audios,{file:e,url:o}].slice(0,this.maxFiles);this.$emit("update:modelValue",u)},this.mediaRecorder.start()},stopRecording(){this.mediaRecorder&&(this.mediaRecorder.stop(),this.isRecording=!1)},removeAudio(l){const e=[...this.audios];URL.revokeObjectURL(e[l].url),e.splice(l,1),this.$emit("update:modelValue",e)}},beforeUnmount(){this.audios.forEach(l=>URL.revokeObjectURL(l.url))}},Te={class:"mb-3"},Ce={class:"form-label fw-bold"},Fe={class:"btn-group mb-2 w-100 p-3",role:"group"},Me=["disabled"],Ie=["disabled"],De={key:0,class:"list-group mt-2 list-group-flush"},Ee=["src"],Pe=["onClick"];function Le(l,e,o,u,s,a){return n(),i("div",Te,[t("label",Ce," Голосовые сообщения (до "+f(o.maxFiles)+") ",1),t("div",Fe,[t("button",{type:"button",class:"btn btn-outline-primary p-2",disabled:s.isRecording||a.audios.length>=o.maxFiles,onClick:e[0]||(e[0]=(...r)=>a.startRecording&&a.startRecording(...r))},[...e[2]||(e[2]=[t("i",{class:"fa-solid fa-microphone"},null,-1),R(" Записать ",-1)])],8,Me),t("button",{type:"button",class:"btn btn-outline-danger p-2",disabled:!s.isRecording,onClick:e[1]||(e[1]=(...r)=>a.stopRecording&&a.stopRecording(...r))},[...e[3]||(e[3]=[t("i",{class:"fa-solid fa-stop"},null,-1),R(" Стоп ",-1)])],8,Ie)]),a.audios.length?(n(),i("ul",De,[(n(!0),i(m,null,y(a.audios,(r,g)=>(n(),i("li",{key:g,class:"list-group-item d-flex justify-content-between align-items-center"},[t("audio",{src:r.url,controls:""},null,8,Ee),t("button",{type:"button",class:"btn btn-link text-danger",onClick:V=>a.removeAudio(g)},[...e[4]||(e[4]=[t("i",{class:"fas fa-trash"},null,-1)])],8,Pe)]))),128))])):p("",!0)])}const j=S(Re,[["render",Le]]),Ae={name:"FileUploader",props:{modelValue:{type:Array,default:()=>[]},maxFiles:{type:Number,default:10}},computed:{files(){return this.modelValue}},methods:{handleFiles(l){const e=Array.from(l.target.files),o=[...this.files,...e].slice(0,this.maxFiles);this.$emit("update:modelValue",o),l.target.value=""},removeFile(l){const e=[...this.files];e.splice(l,1),this.$emit("update:modelValue",e)}}},Ne={class:"mb-3"},Oe={key:0,class:"list-group mt-2"},ze={class:"text-truncate"},He=["onClick"];function je(l,e,o,u,s,a){return n(),i("div",Ne,[e[2]||(e[2]=t("label",{class:"form-label fw-bold"}," Прикрепить документы (до 10 файлов) ",-1)),t("input",{type:"file",class:"form-control",multiple:"",onChange:e[0]||(e[0]=(...r)=>a.handleFiles&&a.handleFiles(...r))},null,32),e[3]||(e[3]=t("small",{class:"text-muted"}," Можно выбрать до 10 файлов любого формата ",-1)),a.files.length?(n(),i("ul",Oe,[(n(!0),i(m,null,y(a.files,(r,g)=>(n(),i("li",{key:g,class:"list-group-item d-flex justify-content-between align-items-center"},[t("span",ze,[e[1]||(e[1]=t("i",{class:"fa-solid fa-paperclip me-2"},null,-1)),R(" "+f(r.name),1)]),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:V=>a.removeFile(g)}," × ",8,He)]))),128))])):p("",!0)])}const G=S(Ae,[["render",je]]),C="/bot-api/municipalities",B=D("municipalities",{state:()=>({items:[],loading:!1,error:null,pagination:null}),getters:{byId:l=>e=>l.items.find(o=>o.id===e)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:l}=await c(C,"GET");this.items=l.data??l,this.pagination=l}catch(l){this.error=(l==null?void 0:l.message)||"Ошибка загрузки муниципалитетов"}finally{this.loading=!1}},async fetchOne(l){try{const{data:e}=await c(`${C}/${l}`,"GET");return e}catch(e){throw this.error=(e==null?void 0:e.message)||"Ошибка загрузки муниципалитета",e}},async create(l){const{data:e}=await c(C,"POST",l);return this.items.push(e),e},async update(l,e){const{data:o}=await c(`${C}/${l}`,"PUT",e),u=this.items.findIndex(s=>s.id===l);return u!==-1&&(this.items[u]=o),o},async remove(l){await c(`${C}/${l}`,"DELETE"),this.items=this.items.filter(o=>o.id!==l),E().show(`Муниципалитет #${l} удалён`)}}}),F="/bot-api/issue-categories",q=D("issueCategories",{state:()=>({items:[],loading:!1,error:null,pagination:null}),getters:{byId:l=>e=>l.items.find(o=>o.id===e)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:l}=await c(F,"GET");this.items=l.data??l,this.pagination=l}catch(l){this.error=(l==null?void 0:l.message)||"Ошибка загрузки категорий"}finally{this.loading=!1}},async fetchOne(l){try{const{data:e}=await c(`${F}/${l}`,"GET");return e}catch(e){throw this.error=(e==null?void 0:e.message)||"Ошибка загрузки категории",e}},async create(l){const{data:e}=await c(F,"POST",l);return this.items.push(e),e},async update(l,e){const{data:o}=await c(`${F}/${l}`,"PUT",e),u=this.items.findIndex(s=>s.id===l);return u!==-1&&(this.items[u]=o),o},async remove(l){await c(`${F}/${l}`,"DELETE"),this.items=this.items.filter(o=>o.id!==l),E().show(`Категория #${l} удалена`)}}}),M="/bot-api/help-formats",W=D("helpFormats",{state:()=>({items:[],loading:!1,error:null,pagination:null}),getters:{byId:l=>e=>l.items.find(o=>o.id===e)},actions:{async fetchAll(){this.loading=!0,this.error=null;try{const{data:l}=await c(M,"GET");this.items=l.data??l,this.pagination=l}catch(l){this.error=(l==null?void 0:l.message)||"Ошибка загрузки типов помощи"}finally{this.loading=!1}},async fetchOne(l){try{const{data:e}=await c(`${M}/${l}`,"GET");return e}catch(e){throw this.error=(e==null?void 0:e.message)||"Ошибка загрузки типа помощи",e}},async create(l){const{data:e}=await c(M,"POST",l);return this.items.push(e),e},async update(l,e){const{data:o}=await c(`${M}/${l}`,"PUT",e),u=this.items.findIndex(s=>s.id===l);return u!==-1&&(this.items[u]=o),o},async remove(l){await c(`${M}/${l}`,"DELETE"),this.items=this.items.filter(o=>o.id!==l),E().show(`Тип помощи #${l} удалён`)}}}),Ge={class:"my-3"},Be={class:"progress"},qe={class:"text-center mt-2"},We={class:"form-floating mb-2"},xe={class:"form-floating mb-2"},_e={class:"form-floating mb-2"},Je=["value"],Xe={class:"form-floating mb-2"},Ke={class:"mb-2"},Qe={class:"form-floating"},Ye=["onUpdate:modelValue"],Ze=["value"],et={class:"input-group-text"},tt=["onClick"],ot=["disabled"],st={class:"form-floating mb-2"},lt={class:"form-floating mb-2"},rt={key:5,class:"card shadow-sm border-light-subtle mb-2"},nt={class:"card-body p-0"},it={class:"list-group list-group-flush"},at={key:0,class:"list-group-item"},dt={class:"ms-2"},mt={key:1,class:"list-group-item"},ut={class:"ms-2"},pt={key:2,class:"list-group-item"},ft={class:"ms-2"},bt={key:3,class:"list-group-item"},gt={class:"mt-1"},yt={class:"fw-bold small"},ct={class:"mb-1 small"},ht={key:4,class:"p-2"},vt={key:5,class:"list-group-item"},kt={class:"mt-1 text-muted"},St={key:6,class:"list-group-item"},wt={class:"mt-1"},Vt={class:"fw-bold small"},$t={class:"mb-1 small"},Ut={key:7,class:"p-2"},Rt={key:8,class:"list-group-item"},Tt={class:"mt-1"},Ct={class:"fw-bold small"},Ft={class:"mb-1 small"},Mt={key:9,class:"p-2"},It={key:10,class:"list-group-item"},Dt={class:"mt-1"},Et={class:"mb-1 small"},Pt={key:11,class:"list-group-item"},Lt={class:"mt-1 text-muted"},At={style:{position:"sticky",bottom:"20px","z-index":"100"}},Nt={class:"btn-group w-100",role:"group","aria-label":"Basic example"},Ot={key:1,type:"submit",class:"btn btn-primary p-3"},zt={key:2,type:"submit",class:"btn btn-primary p-3"},Ht={name:"ReportForm",components:{},data(){return{step:0,maxStep:5,isRecording:!1,mediaRecorder:null,audioChunks:[],helpStore:W(),userStore:I(),municipalityStore:B(),issueStore:q(),selected_problem:null,form:{type:0,phone:null,from_user_id:"",to_user_id:"",municipality_id:"",received_at:"",documents:[],received_from:"",problem_description:"",help_formats:[""],comment:"",problems:[],solutions:[],difficulties:[],audio_files:[]},users:[],officials:[],helpFormats:[]}},computed:{hasAvailableHelpFormats(){return this.helpStore.items.length>this.form.help_formats.length},user(){var l;return((l=this.userStore)==null?void 0:l.self)||null},problems(){var l;return(l=this.issueStore.items)==null?void 0:l.filter(e=>(e==null?void 0:e.type)===0)},solutions(){var l;return(l=this.issueStore.items)==null?void 0:l.filter(e=>(e==null?void 0:e.type)===1)},difficulties(){var l;return(l=this.issueStore.items)==null?void 0:l.filter(e=>(e==null?void 0:e.type)===2)}},mounted(){this.municipalityStore.fetchAll(),this.issueStore.fetchAll(),this.helpStore.fetchAll();const l=new Date;l.setMinutes(l.getMinutes()-l.getTimezoneOffset());const e=l.toISOString().slice(0,10);this.form.received_at=e},methods:{availableHelpFormats(l){const e=this.form.help_formats.filter((o,u)=>u!==l);return this.helpStore.items.filter(o=>!e.includes(o.id))},removeHelpFormat(l){this.form.help_formats.splice(l,1)},addHelpFormat(){this.form.help_formats.length<10&&this.form.help_formats.push("")},submitForm(){this.step++,!(this.step<5)&&console.log("FORM DATA:",this.form)}}},jt=Object.assign(Ht,{setup(l){return(e,o)=>{const u=z("mask");return n(),i("form",{onSubmit:o[13]||(o[13]=O((...s)=>e.submitForm&&e.submitForm(...s),["prevent"])),class:"p-3 border rounded"},[t("div",Ge,[t("div",Be,[t("div",{class:"progress-bar",role:"progressbar",style:H({width:e.step/e.maxStep*100+"%"})},null,4)]),t("p",qe,"Шаг "+f(e.step+1)+" из "+f(e.maxStep+1),1)]),e.step===0?(n(),i(m,{key:0},[o[17]||(o[17]=t("h5",{class:"mb-2"},"Регистрация жалобы",-1)),e.user.role===0?(n(),i(m,{key:0},[t("div",We,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=s=>e.form.received_from=s),required:""},null,512),[[b,e.form.received_from]]),o[14]||(o[14]=t("label",null,"От кого (ФИО)",-1))]),t("div",xe,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=s=>e.form.phone=s),required:""},null,512),[[u,"+7(###) ###-##-##"],[b,e.form.phone]]),o[15]||(o[15]=t("label",null,"Номер телефона",-1))])],64)):p("",!0),t("div",_e,[d(t("select",{class:"form-select","onUpdate:modelValue":o[2]||(o[2]=s=>e.form.municipality_id=s),required:""},[(n(!0),i(m,null,y(e.municipalityStore.items,s=>(n(),i("option",{key:s.id,value:s.id},f(s.name),9,Je))),128))],512),[[v,e.form.municipality_id]]),o[16]||(o[16]=t("label",null,"Муниципалитет",-1))])],64)):p("",!0),e.step===1?(n(),i(m,{key:1},[o[18]||(o[18]=t("h5",{class:"mb-2"},"Какая у вас проблемная ситуация?",-1)),k(L,{modelValue:e.form.problems,"onUpdate:modelValue":o[3]||(o[3]=s=>e.form.problems=s),issues:e.problems},null,8,["modelValue","issues"])],64)):p("",!0),e.step===2?(n(),i(m,{key:2},[o[19]||(o[19]=t("h5",{class:"mb-2"},"Способы решения проблемы",-1)),k(L,{modelValue:e.form.solutions,"onUpdate:modelValue":o[4]||(o[4]=s=>e.form.solutions=s),issues:e.solutions},null,8,["modelValue","issues"])],64)):p("",!0),e.step===3?(n(),i(m,{key:3},[o[20]||(o[20]=t("h5",{class:"mb-2"},"Какие сложности возникли?",-1)),k(L,{modelValue:e.form.difficulties,"onUpdate:modelValue":o[5]||(o[5]=s=>e.form.difficulties=s),issues:e.difficulties},null,8,["modelValue","issues"])],64)):p("",!0),e.step===4?(n(),i(m,{key:4},[o[25]||(o[25]=t("h5",{class:"mb-2"},"Дополнительная информация",-1)),t("div",Xe,[d(t("textarea",{class:"form-control",style:{height:"120px"},"onUpdate:modelValue":o[6]||(o[6]=s=>e.form.problem_description=s)},null,512),[[b,e.form.problem_description]]),o[21]||(o[21]=t("label",null,"Особенности проблемы",-1))]),t("div",Ke,[o[22]||(o[22]=t("label",{class:"form-label small"},"Форматы помощи",-1)),(n(!0),i(m,null,y(e.form.help_formats,(s,a)=>(n(),i("div",{key:a,class:"input-group flex-nowrap mb-2"},[t("div",Qe,[d(t("select",{class:"form-select","onUpdate:modelValue":r=>e.form.help_formats[a]=r},[(n(!0),i(m,null,y(e.availableHelpFormats(a),r=>(n(),i("option",{key:r.id,value:r.id},f(r.name),9,Ze))),128))],8,Ye),[[v,e.form.help_formats[a]]]),t("label",null,"Формат помощи #"+f(a+1),1)]),t("span",et,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm w-100",onClick:r=>e.removeHelpFormat(a)}," × ",8,tt)])]))),128)),t("button",{type:"button",class:"btn btn-outline-primary w-100 p-3",onClick:o[7]||(o[7]=(...s)=>e.addHelpFormat&&e.addHelpFormat(...s)),disabled:!e.hasAvailableHelpFormats}," Добавить формат помощи ",8,ot)]),t("div",st,[d(t("input",{type:"date",class:"form-control","onUpdate:modelValue":o[8]||(o[8]=s=>e.form.received_at=s)},null,512),[[b,e.form.received_at]]),o[23]||(o[23]=t("label",null,"Дата получения",-1))]),t("div",lt,[d(t("textarea",{class:"form-control",style:{height:"100px"},"onUpdate:modelValue":o[9]||(o[9]=s=>e.form.comment=s)},null,512),[[b,e.form.comment]]),o[24]||(o[24]=t("label",null,"Комментарий",-1))]),k(G,{modelValue:e.form.documents,"onUpdate:modelValue":o[10]||(o[10]=s=>e.form.documents=s)},null,8,["modelValue"]),k(j,{modelValue:e.form.audio_files,"onUpdate:modelValue":o[11]||(o[11]=s=>e.form.audio_files=s)},null,8,["modelValue"])],64)):p("",!0),e.step===5?(n(),i("div",rt,[o[38]||(o[38]=t("div",{class:"card-header fw-bold"}," Сводная информация ",-1)),t("div",nt,[t("ul",it,[e.form.received_from?(n(),i("li",at,[o[26]||(o[26]=t("strong",null,"Ф.И.О.:",-1)),t("span",dt,f(e.form.received_from),1)])):p("",!0),e.form.phone?(n(),i("li",mt,[o[27]||(o[27]=t("strong",null,"Телефон:",-1)),t("span",ut,f(e.form.phone),1)])):p("",!0),e.form.municipality_id?(n(),i("li",pt,[o[28]||(o[28]=t("strong",null,"Муниципалитет:",-1)),t("span",ft,f(e.municipalityStore.byId(e.form.municipality_id).name),1)])):p("",!0),e.form.problems.length?(n(),i("li",bt,[o[29]||(o[29]=t("strong",null,"Проблемы:",-1)),t("ul",gt,[(n(!0),i(m,null,y(e.form.problems,(s,a)=>(n(),i(m,null,[s?(n(),i("li",{key:a},[t("h6",yt,f(e.issueStore.byId(a).name),1),(n(!0),i(m,null,y(s,r=>(n(),i("p",ct,f(r),1))),256))])):p("",!0)],64))),256))])])):(n(),i("div",ht,[...o[30]||(o[30]=[t("p",{class:"alert alert-info mb-0"}," Проблемы не указаны текстом ",-1)])])),e.form.problem_description?(n(),i("li",vt,[o[31]||(o[31]=t("strong",null,"Особенности проблемы:",-1)),t("div",kt,f(e.form.problem_description),1)])):p("",!0),e.form.solutions.length?(n(),i("li",St,[o[32]||(o[32]=t("strong",null,"Предложенные решения:",-1)),t("ul",wt,[(n(!0),i(m,null,y(e.form.solutions,(s,a)=>(n(),i(m,null,[s?(n(),i("li",{key:a},[t("h6",Vt,f(e.issueStore.byId(a).name),1),(n(!0),i(m,null,y(s,r=>(n(),i("p",$t,f(r),1))),256))])):p("",!0)],64))),256))])])):(n(),i("div",Ut,[...o[33]||(o[33]=[t("p",{class:"alert alert-info mb-0"}," Предложений ро решению проблемы не поступило ",-1)])])),e.form.difficulties.length?(n(),i("li",Rt,[o[34]||(o[34]=t("strong",null,"Трудности:",-1)),t("ul",Tt,[(n(!0),i(m,null,y(e.form.difficulties,(s,a)=>(n(),i(m,null,[s?(n(),i("li",{key:a},[t("h6",Ct,f(e.issueStore.byId(a).name),1),(n(!0),i(m,null,y(s,r=>(n(),i("p",Ft,f(r),1))),256))])):p("",!0)],64))),256))])])):(n(),i("div",Mt,[...o[35]||(o[35]=[t("p",{class:"alert alert-info mb-0"}," Трудностей реализации не обнаружено ",-1)])])),e.form.help_formats.length?(n(),i("li",It,[o[36]||(o[36]=t("strong",null,"Форматы помощи:",-1)),t("ul",Dt,[(n(!0),i(m,null,y(e.form.help_formats,(s,a)=>(n(),i("li",{key:a},[t("p",Et,f(e.helpStore.byId(s).name),1)]))),128))])])):p("",!0),e.form.comment?(n(),i("li",Pt,[o[37]||(o[37]=t("strong",null,"Комментарий к задаче:",-1)),t("div",Lt,f(e.form.comment),1)])):p("",!0)])])])):p("",!0),t("nav",At,[t("div",Nt,[e.step>0&&e.step<5?(n(),i(m,{key:0},[t("button",{type:"button",onClick:o[12]||(o[12]=s=>e.step--),class:"btn btn-light p-3"},"Назад "),o[39]||(o[39]=t("button",{type:"submit",class:"btn btn-primary p-3"},"Вперед ",-1))],64)):p("",!0),e.step===0?(n(),i("button",Ot,"Приступить ")):p("",!0),e.step===5?(n(),i("button",zt,"Отправить ")):p("",!0)])])],32)}}}),Gt=S(jt,[["__scopeId","data-v-f45e70b8"]]),Bt={class:"form-floating mb-2"},qt={class:"form-floating mb-2"},Wt={class:"form-floating mb-2"},xt=["value"],_t={class:"form-floating mb-2"},Jt={class:"form-floating mb-2"},Xt={class:"form-floating mb-2"},Kt={class:"form-floating mb-2"},Qt={class:"mb-2"},Yt={class:"form-floating"},Zt=["onUpdate:modelValue"],eo=["value"],to={class:"input-group-text"},oo=["onClick"],so=["disabled"],lo={class:"form-floating mb-2"},ro={name:"EventRequestForm",data(){return{helpStore:W(),userStore:I(),municipalityStore:B(),issueStore:q(),form:{event_date:"",description:"",target_audience:"",participants_count:"",help_formats:[""],comment:""}}},computed:{user(){var l;return((l=this.userStore)==null?void 0:l.self)||null},hasAvailableHelpFormats(){return this.helpStore.items.length>this.form.help_formats.length}},mounted(){this.municipalityStore.fetchAll(),this.issueStore.fetchAll(),this.helpStore.fetchAll();const l=new Date;l.setMinutes(l.getMinutes()-l.getTimezoneOffset());const e=l.toISOString().slice(0,10);this.form.event_date=e},methods:{removeHelpFormat(l){this.form.help_formats.splice(l,1)},addHelpFormat(){this.form.help_formats.length<10&&this.form.help_formats.push("")},availableHelpFormats(l){const e=this.form.help_formats.filter((o,u)=>u!==l);return this.helpStore.items.filter(o=>!e.includes(o.id))},submitForm(){console.log("FORM:",this.form)}}},no=Object.assign(ro,{setup(l){return(e,o)=>{const u=z("mask");return n(),i("form",{class:"p-3",onSubmit:o[11]||(o[11]=O((...s)=>e.submitForm&&e.submitForm(...s),["prevent"]))},[o[21]||(o[21]=t("h5",{class:"mb-2"},"Заявка на мероприятие",-1)),e.user.role===0?(n(),i(m,{key:0},[t("div",Bt,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=s=>e.form.received_from=s),required:""},null,512),[[b,e.form.received_from]]),o[12]||(o[12]=t("label",null,"От кого (ФИО)",-1))]),t("div",qt,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=s=>e.form.phone=s),required:""},null,512),[[u,"+7(###) ###-##-##"],[b,e.form.phone]]),o[13]||(o[13]=t("label",null,"Номер телефона",-1))])],64)):p("",!0),t("div",Wt,[d(t("select",{class:"form-select","onUpdate:modelValue":o[2]||(o[2]=s=>e.form.municipality_id=s),required:""},[(n(!0),i(m,null,y(e.municipalityStore.items,s=>(n(),i("option",{key:s.id,value:s.id},f(s.name),9,xt))),128))],512),[[v,e.form.municipality_id]]),o[14]||(o[14]=t("label",null,"Муниципалитет",-1))]),t("div",_t,[d(t("input",{type:"date",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=s=>e.form.event_date=s)},null,512),[[b,e.form.event_date]]),o[15]||(o[15]=t("label",null,"Дата мероприятия",-1))]),t("div",Jt,[d(t("textarea",{class:"form-control",style:{height:"120px"},"onUpdate:modelValue":o[4]||(o[4]=s=>e.form.description=s)},null,512),[[b,e.form.description]]),o[16]||(o[16]=t("label",null,"Описание мероприятия",-1))]),t("div",Xt,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=s=>e.form.target_audience=s)},null,512),[[b,e.form.target_audience]]),o[17]||(o[17]=t("label",null,"Целевая аудитория",-1))]),t("div",Kt,[d(t("input",{type:"number",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=s=>e.form.participants_count=s)},null,512),[[b,e.form.participants_count]]),o[18]||(o[18]=t("label",null,"Количество участников",-1))]),t("div",Qt,[o[19]||(o[19]=t("label",{class:"form-label small"},"Форматы помощи",-1)),(n(!0),i(m,null,y(e.form.help_formats,(s,a)=>(n(),i("div",{key:a,class:"input-group flex-nowrap mb-2"},[t("div",Yt,[d(t("select",{class:"form-select","onUpdate:modelValue":r=>e.form.help_formats[a]=r},[(n(!0),i(m,null,y(e.availableHelpFormats(a),r=>(n(),i("option",{key:r.id,value:r.id},f(r.name),9,eo))),128))],8,Zt),[[v,e.form.help_formats[a]]]),t("label",null,"Формат помощи #"+f(a+1),1)]),t("span",to,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm w-100",onClick:r=>e.removeHelpFormat(a)}," × ",8,oo)])]))),128)),t("button",{type:"button",class:"btn btn-outline-primary w-100 p-3",onClick:o[7]||(o[7]=(...s)=>e.addHelpFormat&&e.addHelpFormat(...s)),disabled:!e.hasAvailableHelpFormats}," Добавить формат помощи ",8,so)]),t("div",lo,[d(t("textarea",{class:"form-control",style:{height:"100px"},"onUpdate:modelValue":o[8]||(o[8]=s=>e.form.comment=s)},null,512),[[b,e.form.comment]]),o[20]||(o[20]=t("label",null,"Комментарий",-1))]),k(G,{modelValue:e.form.documents,"onUpdate:modelValue":o[9]||(o[9]=s=>e.form.documents=s)},null,8,["modelValue"]),k(j,{modelValue:e.form.audio_files,"onUpdate:modelValue":o[10]||(o[10]=s=>e.form.audio_files=s)},null,8,["modelValue"]),o[22]||(o[22]=t("button",{class:"btn btn-primary w-100 p-3"},"Отправить",-1))],32)}}}),io=S(no,[["__scopeId","data-v-33fc7340"]]),ao={name:"VolunteerForm",data(){return{step:1,maxStep:6,skillsList:["Работа с людьми","Физическая работа","Экспертные знания в определенной сфере","Организация мероприятий","Дизайн","SMM","IT","Фото/видео","Юридическая помощь","Аналитика"],directionsList:["Мероприятия","Информационная поддержка","Аналитика","Физическая работа","Работа с людьми","Логистика","IT","Профессиональная помощь","Юридическая помощь"],clothingSizes:["XS","S","M","L","XL","XXL"],healthOptions:[{id:1,icon:"fa-solid fa-head-side-mask",label:"Часто болею",value:"болею"},{id:2,icon:"fa-solid fa-ear-deaf",label:"Плохо слышит / говорит",value:"плохо слышит или говорит"},{id:3,icon:"fa-solid fa-glasses",label:"Слабовидящий",value:"слабовидящий"},{id:4,icon:"fa-solid fa-wheelchair",label:"Ограничения мобильности",value:"ограничения мобильности"},{id:5,icon:"fa-solid fa-person-dots-from-line",label:"Разновидности аллергии",value:"аллергия"}],form:{lastName:"",firstName:"",middleName:"",birthDate:"",gender:"",citizenship:"",phone:"",email:"",city:"",address:"",preferredContact:"",telegram:"",whatsapp:"",vk:"",website:"",profession:"",skills:[],languages:"",hasExperience:null,experience:1,experienceDetails:"",readyToLearn:"",timePerWeek:"",participationFormat:"",canTravel:"",weekendWork:"",directions:[],otherDirection:"",clothingSize:"",sendTasks:!1,motivation:"",health:"",comment:"",agreePersonal:!1,agreeNotifications:!1,agreeEvents:!1,healthLimit:null,healthDetails:[]},errors:{}}},methods:{validateStep(){return this.errors={},this.step===1&&(this.form.lastName||(this.errors.lastName="Введите фамилию"),this.form.firstName||(this.errors.firstName="Введите имя"),this.form.birthDate||(this.errors.birthDate="Укажите дату рождения")),this.step===2&&(this.form.phone||(this.errors.phone="Введите телефон"),this.form.email||(this.errors.email="Введите email"),this.form.city||(this.errors.city="Укажите город")),this.step===6&&(this.form.agreePersonal||(this.errors.agreePersonal="Необходимо согласие")),Object.keys(this.errors).length===0},handleSubmit(l){if(l.preventDefault(),!!this.validateStep()){if(this.step<this.maxStep){this.step++;return}console.log("SUBMIT DATA:",JSON.parse(JSON.stringify(this.form))),alert("Анкета отправлена!")}}}},mo={class:"my-3"},uo={class:"progress"},po={class:"text-center mt-2"},fo={class:"form-floating mb-2"},bo={class:"text-danger small mb-2"},go={class:"form-floating mb-2"},yo={class:"text-danger small mb-2"},co={class:"form-floating mb-2"},ho={class:"form-floating mb-2"},vo={class:"text-danger small mb-2"},ko={class:"form-floating mb-2"},So={class:"form-floating mb-2"},wo={class:"form-floating mb-2"},Vo={class:"text-danger small mb-2"},$o={class:"form-floating mb-2"},Uo={class:"text-danger small mb-2"},Ro={class:"form-floating mb-2"},To={class:"text-danger small mb-2"},Co={class:"form-floating mb-2"},Fo={class:"form-floating mb-2"},Mo={class:"form-floating mb-2"},Io={class:"form-floating mb-2"},Do={class:"form-floating mb-2"},Eo={class:"form-floating mb-2"},Po={class:"form-floating mb-2"},Lo={class:"mb-2"},Ao=["id","value"],No=["for"],Oo={class:"form-floating mb-2"},zo={class:"form-floating mb-2"},Ho={key:0,class:"form-floating mb-2"},jo={class:"form-floating mb-2"},Go={class:"form-floating mb-2"},Bo={class:"form-floating mb-2"},qo={class:"form-floating mb-2"},Wo={class:"form-floating mb-2"},xo={class:"form-floating mb-2"},_o={class:"mb-2"},Jo=["id","value"],Xo=["for"],Ko={class:"form-floating mb-2"},Qo={class:"form-floating mb-2"},Yo=["value"],Zo={class:"form-check mb-2"},es={class:"form-floating mb-2"},ts={class:"form-floating mb-2"},os={class:"list-group my-3"},ss={key:0,class:"list-group my-3"},ls=["for"],rs=["id","value"],ns={class:"form-floating mb-2"},is={class:"form-check mb-2"},as={class:"text-danger small"},ds={class:"form-check mb-2"},ms={class:"form-check mb-2"},us={style:{position:"sticky",bottom:"20px","z-index":"100"}},ps={class:"btn-group w-100",role:"group","aria-label":"Basic example"},fs={key:1,type:"submit",class:"btn btn-primary p-3"},bs={key:2,type:"submit",class:"btn btn-primary p-3"};function gs(l,e,o,u,s,a){return n(),i("form",{onSubmit:e[40]||(e[40]=(...r)=>a.handleSubmit&&a.handleSubmit(...r)),class:"p-3 border rounded"},[t("div",mo,[t("div",uo,[t("div",{class:"progress-bar",role:"progressbar",style:H({width:s.step/s.maxStep*100+"%"})},null,4)]),t("p",po,"Шаг "+f(s.step)+" из "+f(s.maxStep),1)]),s.step===1?(n(),i(m,{key:0},[e[48]||(e[48]=t("h5",{class:"mb-3"},"Личные данные",-1)),t("div",fo,[d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.form.lastName=r),class:"form-control",id:"lastName",placeholder:"Фамилия"},null,512),[[b,s.form.lastName]]),e[41]||(e[41]=t("label",{for:"lastName"},"Фамилия",-1))]),t("div",bo,f(s.errors.lastName),1),t("div",go,[d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.form.firstName=r),class:"form-control",id:"firstName",placeholder:"Имя"},null,512),[[b,s.form.firstName]]),e[42]||(e[42]=t("label",{for:"firstName"},"Имя",-1))]),t("div",yo,f(s.errors.firstName),1),t("div",co,[d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.form.middleName=r),class:"form-control",id:"middleName",placeholder:"Отчество"},null,512),[[b,s.form.middleName]]),e[43]||(e[43]=t("label",{for:"middleName"},"Отчество",-1))]),t("div",ho,[d(t("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=r=>s.form.birthDate=r),class:"form-control",id:"birthDate",placeholder:"Дата рождения"},null,512),[[b,s.form.birthDate]]),e[44]||(e[44]=t("label",{for:"birthDate"},"Дата рождения",-1))]),t("div",vo,f(s.errors.birthDate),1),t("div",ko,[d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=r=>s.form.gender=r),class:"form-select",id:"gender"},[...e[45]||(e[45]=[t("option",{value:""},"Не выбрано",-1),t("option",{value:"1"},"Мужской",-1),t("option",{value:"0"},"Женский",-1)])],512),[[v,s.form.gender]]),e[46]||(e[46]=t("label",{for:"gender"},"Пол",-1))]),t("div",So,[d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>s.form.citizenship=r),class:"form-control",id:"citizenship",placeholder:"Гражданство"},null,512),[[b,s.form.citizenship]]),e[47]||(e[47]=t("label",{for:"citizenship"},"Гражданство",-1))])],64)):p("",!0),s.step===2?(n(),i(m,{key:1},[e[55]||(e[55]=t("h5",{class:"mb-3"},"Контакты",-1)),t("div",wo,[d(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>s.form.phone=r),class:"form-control",id:"phone",placeholder:"Телефон"},null,512),[[b,s.form.phone]]),e[49]||(e[49]=t("label",{for:"phone"},"Телефон",-1))]),t("div",Vo,f(s.errors.phone),1),t("div",$o,[d(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>s.form.email=r),class:"form-control",id:"email",placeholder:"Email"},null,512),[[b,s.form.email]]),e[50]||(e[50]=t("label",{for:"email"},"Email",-1))]),t("div",Uo,f(s.errors.email),1),t("div",Ro,[d(t("input",{"onUpdate:modelValue":e[8]||(e[8]=r=>s.form.city=r),class:"form-control",id:"city",placeholder:"Город"},null,512),[[b,s.form.city]]),e[51]||(e[51]=t("label",{for:"city"},"Город",-1))]),t("div",To,f(s.errors.city),1),t("div",Co,[d(t("input",{"onUpdate:modelValue":e[9]||(e[9]=r=>s.form.address=r),class:"form-control",id:"address",placeholder:"Адрес"},null,512),[[b,s.form.address]]),e[52]||(e[52]=t("label",{for:"address"},"Адрес (необязательно)",-1))]),t("div",Fo,[d(t("select",{"onUpdate:modelValue":e[10]||(e[10]=r=>s.form.preferredContact=r),class:"form-select",id:"preferredContact"},[...e[53]||(e[53]=[t("option",{value:""},"Не выбрано",-1),t("option",null,"Телефон",-1),t("option",null,"Мессенджер",-1),t("option",null,"Email",-1)])],512),[[v,s.form.preferredContact]]),e[54]||(e[54]=t("label",{for:"preferredContact"},"Предпочтительный способ связи",-1))])],64)):p("",!0),s.step===3?(n(),i(m,{key:2},[e[60]||(e[60]=t("h5",{class:"mb-3"},"Мессенджеры и соцсети",-1)),t("div",Mo,[d(t("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>s.form.telegram=r),class:"form-control",id:"telegram",placeholder:"@username"},null,512),[[b,s.form.telegram]]),e[56]||(e[56]=t("label",{for:"telegram"},"Telegram",-1))]),t("div",Io,[d(t("input",{"onUpdate:modelValue":e[12]||(e[12]=r=>s.form.whatsapp=r),class:"form-control",id:"whatsapp",placeholder:"WhatsApp"},null,512),[[b,s.form.whatsapp]]),e[57]||(e[57]=t("label",{for:"whatsapp"},"WhatsApp",-1))]),t("div",Do,[d(t("input",{"onUpdate:modelValue":e[13]||(e[13]=r=>s.form.vk=r),class:"form-control",id:"vk",placeholder:"VK / Facebook / Instagram"},null,512),[[b,s.form.vk]]),e[58]||(e[58]=t("label",{for:"vk"},"VK / Facebook / Instagram",-1))]),t("div",Eo,[d(t("input",{"onUpdate:modelValue":e[14]||(e[14]=r=>s.form.website=r),class:"form-control",id:"website",placeholder:"Сайт"},null,512),[[b,s.form.website]]),e[59]||(e[59]=t("label",{for:"website"},"Личный сайт",-1))])],64)):p("",!0),s.step===4?(n(),i(m,{key:3},[e[70]||(e[70]=t("h5",{class:"mb-3"},"Профессиональная информация",-1)),t("div",Po,[d(t("input",{"onUpdate:modelValue":e[15]||(e[15]=r=>s.form.profession=r),class:"form-control",id:"profession",placeholder:"Профессия"},null,512),[[b,s.form.profession]]),e[61]||(e[61]=t("label",{for:"profession"},"Профессия",-1))]),t("div",Lo,[e[62]||(e[62]=t("label",{class:"form-label d-block"},"Навыки",-1)),(n(!0),i(m,null,y(s.skillsList,(r,g)=>(n(),i("div",{class:"form-check mb-1",key:g},[d(t("input",{class:"form-check-input",type:"checkbox",id:"skill"+g,value:r,"onUpdate:modelValue":e[16]||(e[16]=V=>s.form.skills=V)},null,8,Ao),[[$,s.form.skills]]),t("label",{class:"form-check-label",for:"skill"+g},f(r),9,No)]))),128))]),t("div",Oo,[d(t("input",{"onUpdate:modelValue":e[17]||(e[17]=r=>s.form.languages=r),class:"form-control",id:"languages",placeholder:"Языки"},null,512),[[b,s.form.languages]]),e[63]||(e[63]=t("label",{for:"languages"},"Иностранные языки",-1))]),t("div",zo,[d(t("select",{"onUpdate:modelValue":e[18]||(e[18]=r=>s.form.hasExperience=r),class:"form-select",id:"hasExperience"},[...e[64]||(e[64]=[t("option",{value:""},"Не выбрано",-1),t("option",{value:!0},"Да",-1),t("option",{value:!1},"Нет",-1)])],512),[[v,s.form.hasExperience]]),e[65]||(e[65]=t("label",{for:"hasExperience"},"Опыт волонтёрства",-1))]),s.form.hasExperience===!0?(n(),i(m,{key:0},[s.form.hasExperience?(n(),i("div",Ho,[d(t("input",{"onUpdate:modelValue":e[19]||(e[19]=r=>s.form.experience=r),class:"form-control",id:"languages",placeholder:"Языки"},null,512),[[b,s.form.experience]]),e[66]||(e[66]=t("label",{for:"languages"},"Сколько лет опыта?",-1))])):p("",!0)],64)):p("",!0),t("div",jo,[d(t("textarea",{"onUpdate:modelValue":e[20]||(e[20]=r=>s.form.experienceDetails=r),class:"form-control",id:"experienceDetails",placeholder:"Опыт",style:{height:"100px"}},null,512),[[b,s.form.experienceDetails]]),e[67]||(e[67]=t("label",{for:"experienceDetails"},"Какие задачи выполняли",-1))]),t("div",Go,[d(t("select",{"onUpdate:modelValue":e[21]||(e[21]=r=>s.form.readyToLearn=r),class:"form-select",id:"readyToLearn"},[...e[68]||(e[68]=[t("option",{value:""},"Не выбрано",-1),t("option",null,"Да",-1),t("option",null,"Нет",-1)])],512),[[v,s.form.readyToLearn]]),e[69]||(e[69]=t("label",{for:"readyToLearn"},"Готовность к обучению",-1))])],64)):p("",!0),s.step===5?(n(),i(m,{key:4},[e[82]||(e[82]=t("h5",{class:"mb-3"},"Готовность к участию",-1)),t("div",Bo,[d(t("input",{"onUpdate:modelValue":e[22]||(e[22]=r=>s.form.timePerWeek=r),class:"form-control",id:"timePerWeek",placeholder:"Часы"},null,512),[[b,s.form.timePerWeek]]),e[71]||(e[71]=t("label",{for:"timePerWeek"},"Часы в неделю",-1))]),t("div",qo,[d(t("select",{"onUpdate:modelValue":e[23]||(e[23]=r=>s.form.participationFormat=r),class:"form-select",id:"participationFormat"},[...e[72]||(e[72]=[t("option",null,"Онлайн",-1),t("option",null,"Офлайн",-1),t("option",null,"Смешанный",-1)])],512),[[v,s.form.participationFormat]]),e[73]||(e[73]=t("label",{for:"participationFormat"},"Формат участия",-1))]),t("div",Wo,[d(t("select",{"onUpdate:modelValue":e[24]||(e[24]=r=>s.form.canTravel=r),class:"form-select",id:"canTravel"},[...e[74]||(e[74]=[t("option",null,"Да",-1),t("option",null,"Нет",-1)])],512),[[v,s.form.canTravel]]),e[75]||(e[75]=t("label",{for:"canTravel"},"Возможность выезжать",-1))]),t("div",xo,[d(t("select",{"onUpdate:modelValue":e[25]||(e[25]=r=>s.form.weekendWork=r),class:"form-select",id:"weekendWork"},[...e[76]||(e[76]=[t("option",null,"Да",-1),t("option",null,"Нет",-1)])],512),[[v,s.form.weekendWork]]),e[77]||(e[77]=t("label",{for:"weekendWork"},"Работа в выходные",-1))]),t("div",_o,[e[78]||(e[78]=t("label",{class:"form-label d-block"},"Направления деятельности",-1)),(n(!0),i(m,null,y(s.directionsList,(r,g)=>(n(),i("div",{class:"form-check mb-1",key:g},[d(t("input",{class:"form-check-input",type:"checkbox",id:"direction"+g,value:r,"onUpdate:modelValue":e[26]||(e[26]=V=>s.form.directions=V)},null,8,Jo),[[$,s.form.directions]]),t("label",{class:"form-check-label",for:"direction"+g},f(r),9,Xo)]))),128))]),t("div",Ko,[d(t("input",{"onUpdate:modelValue":e[27]||(e[27]=r=>s.form.otherDirection=r),class:"form-control",id:"otherDirection",placeholder:"Другое"},null,512),[[b,s.form.otherDirection]]),e[79]||(e[79]=t("label",{for:"otherDirection"},"Другое направление",-1))]),t("div",Qo,[d(t("select",{"onUpdate:modelValue":e[28]||(e[28]=r=>s.form.clothingSize=r),class:"form-select",id:"clothingSize"},[(n(!0),i(m,null,y(s.clothingSizes,(r,g)=>(n(),i("option",{key:g,value:r},f(r),9,Yo))),128))],512),[[v,s.form.clothingSize]]),e[80]||(e[80]=t("label",{for:"clothingSize"},"Размер одежды (мерч)",-1))]),t("div",Zo,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[29]||(e[29]=r=>s.form.sendTasks=r),class:"form-check-input",id:"sendTasks"},null,512),[[$,s.form.sendTasks]]),e[81]||(e[81]=t("label",{class:"form-check-label",for:"sendTasks"},"Присылать задания волонтёра",-1))])],64)):p("",!0),s.step===6?(n(),i(m,{key:5},[e[91]||(e[91]=t("h5",{class:"mb-3"},"Дополнительные сведения",-1)),t("div",es,[d(t("textarea",{"onUpdate:modelValue":e[30]||(e[30]=r=>s.form.motivation=r),class:"form-control",id:"motivation",placeholder:"Причина",style:{height:"100px"}},null,512),[[b,s.form.motivation]]),e[83]||(e[83]=t("label",{for:"motivation"},"Почему хотите стать волонтёром",-1))]),t("div",ts,[d(t("textarea",{"onUpdate:modelValue":e[31]||(e[31]=r=>s.form.health=r),class:"form-control",id:"health",placeholder:"Ограничения",style:{height:"100px"}},null,512),[[b,s.form.health]]),e[84]||(e[84]=t("label",{for:"health"},"Ограничения по здоровью",-1))]),e[92]||(e[92]=t("h6",{class:"opacity-75 mt-3"},"Ограничения по здоровью",-1)),t("div",os,[t("a",{href:"javascript:void(0)",class:P(["list-group-item list-group-item-action p-3",{active:s.form.healthLimit==="none"}]),onClick:e[32]||(e[32]=r=>{s.form.healthLimit="none",s.form.healthDetails=[]})},[...e[85]||(e[85]=[t("i",{class:"fa-regular fa-heart mr-2"},null,-1),t("span",{class:"px-2"},"Нет ограничений по здоровью",-1)])],2),t("a",{href:"javascript:void(0)",class:P(["list-group-item list-group-item-action p-3",{active:s.form.healthLimit==="has"}]),onClick:e[33]||(e[33]=r=>s.form.healthLimit="has")},[...e[86]||(e[86]=[t("i",{class:"fa-solid fa-house-medical-flag mr-2"},null,-1),t("span",{class:"px-2"},"Есть ограничения по здоровью",-1)])],2)]),s.form.healthLimit==="has"?(n(),i("div",ss,[(n(!0),i(m,null,y(s.healthOptions,r=>(n(),i("a",{key:r.id,href:"javascript:void(0)",class:"list-group-item list-group-item-action p-3 d-flex justify-content-between"},[t("label",{for:"health-"+r.id},[t("i",{class:P(r.icon+" mr-2")},null,2),R(" "+f(r.label),1)],8,ls),d(t("input",{type:"checkbox",class:"form-check-input",id:"health-"+r.id,value:r.value,"onUpdate:modelValue":e[34]||(e[34]=g=>s.form.healthDetails=g)},null,8,rs),[[$,s.form.healthDetails]])]))),128))])):p("",!0),t("div",ns,[d(t("textarea",{"onUpdate:modelValue":e[35]||(e[35]=r=>s.form.comment=r),class:"form-control",id:"comment",placeholder:"Комментарий",style:{height:"100px"}},null,512),[[b,s.form.comment]]),e[87]||(e[87]=t("label",{for:"comment"},"Комментарий",-1))]),t("div",is,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[36]||(e[36]=r=>s.form.agreePersonal=r),class:"form-check-input",id:"agreePersonal"},null,512),[[$,s.form.agreePersonal]]),e[88]||(e[88]=t("label",{class:"form-check-label",for:"agreePersonal"},"Согласие на обработку персональных данных",-1)),t("div",as,f(s.errors.agreePersonal),1)]),t("div",ds,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[37]||(e[37]=r=>s.form.agreeNotifications=r),class:"form-check-input",id:"agreeNotifications"},null,512),[[$,s.form.agreeNotifications]]),e[89]||(e[89]=t("label",{class:"form-check-label",for:"agreeNotifications"},"Согласие на уведомления",-1))]),t("div",ms,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[38]||(e[38]=r=>s.form.agreeEvents=r),class:"form-check-input",id:"agreeEvents"},null,512),[[$,s.form.agreeEvents]]),e[90]||(e[90]=t("label",{class:"form-check-label",for:"agreeEvents"},"Согласие на участие в мероприятиях",-1))])],64)):p("",!0),t("nav",us,[t("div",ps,[s.step>1&&s.step<5?(n(),i(m,{key:0},[t("button",{type:"button",onClick:e[39]||(e[39]=r=>s.step--),class:"btn btn-light p-3"},"Назад "),e[93]||(e[93]=t("button",{type:"submit",class:"btn btn-primary p-3"},"Вперед ",-1))],64)):p("",!0),s.step===1?(n(),i("button",fs,"Вперед ")):p("",!0),s.step===5?(n(),i("button",bs,"Отправить ")):p("",!0)])])],32)}const ys=S(ao,[["render",gs]]),cs={key:0,class:"btn-group-vertical w-100",role:"group","aria-label":"Вертикальное меню"},hs={data(){return{tab:"main"}},methods:{hideModal(l){const e=document.getElementById(l);bootstrap.Modal.getInstance(e).hide()}}},vs=Object.assign(hs,{__name:"MenuUser",setup(l){return(e,o)=>(n(),i(m,null,[e.tab==="main"?(n(),i("div",cs,[t("button",{type:"button",onClick:o[0]||(o[0]=u=>e.tab="incoming-request"),class:"btn btn-outline-primary p-3"},"Жалоба на проблему"),t("button",{type:"button",onClick:o[1]||(o[1]=u=>e.tab="event-request"),class:"btn btn-outline-primary p-3"},"Запрос на проведение мероприятия"),t("button",{type:"button",onClick:o[2]||(o[2]=u=>e.tab="volunteer-form"),class:"btn btn-outline-primary p-3"},"Стать волонтером")])):p("",!0),e.tab==="incoming-request"?(n(),i(m,{key:1},[t("button",{onClick:o[3]||(o[3]=u=>e.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"80px","z-index":"100"}},"К меню"),k(Gt)],64)):p("",!0),e.tab==="event-request"?(n(),i(m,{key:2},[t("button",{onClick:o[4]||(o[4]=u=>e.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"80px","z-index":"100"}},"К меню"),k(io)],64)):p("",!0),e.tab==="volunteer-form"?(n(),i(m,{key:3},[t("button",{onClick:o[5]||(o[5]=u=>e.tab="main"),class:"btn btn-light text-secondary mb-3",style:{position:"sticky",top:"80px","z-index":"100"}},"К меню"),k(ys)],64)):p("",!0)],64))}}),A="/bot-api/admins",ks=D("admins",{state:()=>({items:[],loading:!1,error:null}),getters:{byId:l=>e=>l.items.find(o=>o.id===e)},actions:{async fetchAdminsByPage(l=1){const{data:e}=await c(`${A}?page=${l}`,"GET");this.items=e.data,this.pagination=e},async fetchByUrl(l){const{data:e}=await c(l,"GET");this.items=e.data,this.pagination=e},async downloadPersonalAdminReport(l){var o,u;const e=E();e.show("Подготавливаем отчет"),this.loading=!0,this.error=null;try{const{data:s}=await c(`${A}/download-personal-report`,"POST",l);return e.show("Отчет отправлен","success"),s}catch(s){throw this.error=((u=(o=s.response)==null?void 0:o.data)==null?void 0:u.message)??"Ошибка отправки отчёта",e.show(this.error,"error"),s}finally{this.loading=!1}},async downloadReport(l){var e,o;this.loading=!0,this.error=null;try{const{data:u}=await c(`${A}/download-report`,"POST",l);return u}catch(u){throw this.error=((o=(e=u.response)==null?void 0:e.data)==null?void 0:o.message)??"Ошибка отправки отчёта",u}finally{this.loading=!1}}}}),Ss={name:"ReportGenerator",props:["type","isSimple"],data(){return{need_more_options:!1,adminsStore:ks(),report:{result_type:0,startDate:"",endDate:"",type:this.type||"",restriction:null}}},methods:{generateReport(){const l={...this.report};this.$emit("generate-report",l)}}},ws={class:"form-floating mb-2"},Vs={class:"form-floating mb-2"},$s={class:"form-floating mb-2"},Us=["disabled"];function Rs(l,e,o,u,s,a){return n(),i("form",{onSubmit:e[3]||(e[3]=O((...r)=>a.generateReport&&a.generateReport(...r),["prevent"]))},[t("div",ws,[d(t("input",{type:"date",class:"form-control",id:"startDate","onUpdate:modelValue":e[0]||(e[0]=r=>s.report.startDate=r),required:""},null,512),[[b,s.report.startDate]]),e[4]||(e[4]=t("label",{for:"startDate"},"Дата начала периода",-1))]),t("div",Vs,[d(t("input",{type:"date",class:"form-control",id:"endDate","onUpdate:modelValue":e[1]||(e[1]=r=>s.report.endDate=r),required:""},null,512),[[b,s.report.endDate]]),e[5]||(e[5]=t("label",{for:"endDate"},"Дата окончания периода",-1))]),t("div",$s,[d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.report.result_type=r),class:"form-select",id:"floatingSelect","aria-label":"Floating label select example"},[...e[6]||(e[6]=[t("option",{value:"0"},"Классический отчет",-1),t("option",{value:"1"},"Расширенный отчет",-1)])],512),[[v,s.report.result_type]]),e[7]||(e[7]=t("label",{for:"floatingSelect"},"Как вывести результат",-1))]),t("button",{disabled:s.adminsStore.loading,type:"submit",class:"btn btn-primary p-3 w-100"}," Сформировать отчёт ",8,Us)],32)}const Ts=S(Ss,[["render",Rs]]),Cs={class:"btn-group-vertical w-100",role:"group","aria-label":"Вертикальное меню отчетов"},Fs={class:"modal fade",id:"reportModal",tabindex:"-1"},Ms={class:"modal-dialog"},Is={class:"modal-content"},Ds={class:"modal-body"},Es={data(){return{reportStore:J()}},methods:{goTo(l){this.$router.push({name:l})},handleReport(l){bootstrap.Modal.getInstance(document.getElementById("reportModal")).hide(),this.reportStore.exportFull(l)}}},Ps=Object.assign(Es,{__name:"MenuSuperAdmin",setup(l){return(e,o)=>(n(),i(m,null,[t("div",Cs,[o[8]||(o[8]=t("button",{type:"button",class:"btn btn-outline-primary p-3","data-bs-toggle":"modal","data-bs-target":"#reportModal"}," Сформировать отчет ",-1)),t("button",{type:"button",onClick:o[0]||(o[0]=u=>e.goTo("SalePage")),class:"btn btn-outline-primary p-3"},"Список продаж "),t("button",{type:"button",onClick:o[1]||(o[1]=u=>e.goTo("UserPage")),class:"btn btn-outline-primary p-3"},"Список пользователей "),t("button",{type:"button",onClick:o[2]||(o[2]=u=>e.goTo("SupplierPage")),class:"btn btn-outline-primary p-3"},"Список поставщиков "),t("button",{type:"button",onClick:o[3]||(o[3]=u=>e.goTo("AgentPage")),class:"btn btn-outline-primary p-3"},"Список младших админов "),t("button",{type:"button",onClick:o[4]||(o[4]=u=>e.goTo("AdminPage")),class:"btn btn-outline-primary p-3"},"Список админов "),t("button",{type:"button",onClick:o[5]||(o[5]=u=>e.goTo("ProductPage")),class:"btn btn-outline-primary p-3"},"Работа с товаром ")]),o[10]||(o[10]=t("hr",{class:"my-3"},null,-1)),t("button",{type:"button",onClick:o[6]||(o[6]=u=>e.goTo("ExcelExportPage")),class:"btn btn-outline-success p-3 w-100 mb-2"},"Выгрузка данных в эксель "),t("button",{type:"button",onClick:o[7]||(o[7]=u=>e.goTo("BirthdayPage")),class:"btn btn-outline-warning p-3 w-100"},"Дни рождения "),t("div",Fs,[t("div",Ms,[t("div",Is,[o[9]||(o[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Генератор отчетов"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",Ds,[k(Ts,{onGenerateReport:e.handleReport},null,8,["onGenerateReport"])])])])])],64))}}),Ls={name:"RoleSwitcher",data(){return{userStore:I(),selectedRole:I().self.role||0,roles:{0:"Пользователь",1:"Младший администратор",2:"Поставщик",3:"Администратор",4:"Суперадмин"}}},computed:{baseRoleLabel(){return this.roles[this.userStore.self.base_role??0]},roleLabel(){return this.roles[this.userStore.self.role??0]}},methods:{changeRole(){this.userStore.setRole(this.selectedRole),this.$emit("role-changed",this.selectedRole)}}},As={class:"form-floating my-2 w-100"},Ns={class:"mt-2"},Os={key:0,class:"mt-2"};function zs(l,e,o,u,s,a){return n(),i(m,null,[t("div",As,[d(t("select",{id:"roleSelect",class:"form-select","onUpdate:modelValue":e[0]||(e[0]=r=>s.selectedRole=r),onChange:e[1]||(e[1]=(...r)=>a.changeRole&&a.changeRole(...r))},[...e[2]||(e[2]=[t("option",{value:0},"Пользователь",-1),t("option",{value:1},"Волонтер",-1),t("option",{value:2},"Должностное лицо",-1),t("option",{value:3},"Администратор",-1),t("option",{value:4},"Суперадмин",-1)])],544),[[v,s.selectedRole]]),e[3]||(e[3]=t("label",{for:"roleSelect",class:"form-label"},"Сменить роль",-1))]),t("p",Ns,[e[4]||(e[4]=R(" Текущая роль: ",-1)),t("strong",null,f(a.roleLabel),1)]),a.roleLabel!==a.baseRoleLabel?(n(),i("p",Os,[e[5]||(e[5]=R(" Базовая роль: ",-1)),t("strong",null,f(a.baseRoleLabel),1)])):p("",!0)],64)}const Hs=S(Ls,[["render",zs]]),js={methods:{goTo(l){this.$router.push({name:l})},handleReport(l){bootstrap.Modal.getInstance(document.getElementById("reportModal")).hide(),console.log("Отчёт сформирован:",l)},async fetchData(){bootstrap.Modal.getInstance(document.getElementById("newSaleModal")).hide()}}},Gs={class:"btn-group-vertical w-100",role:"group","aria-label":"Вертикальное меню действий"},Bs={class:"modal fade",id:"reportModal",tabindex:"-1"},qs={class:"modal-dialog"},Ws={class:"modal-content"},xs={class:"modal-body"};function _s(l,e,o,u,s,a){const r=N("ReportGenerator");return n(),i(m,null,[t("div",Gs,[t("button",{type:"button",onClick:e[0]||(e[0]=g=>a.goTo("SalePage")),class:"btn btn-outline-primary p-3"},"Список активных заданий"),e[1]||(e[1]=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#newSaleModal",class:"btn btn-outline-primary p-3"},"Список выполненных заданий",-1)),e[2]||(e[2]=t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#newSaleModal",class:"btn btn-outline-primary p-3"},"Отчет по работе",-1))]),e[4]||(e[4]=x('<div class="modal fade" id="newSaleModal" tabindex="-1"><div class="modal-dialog modal-fullscreen"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Создание задания</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"></div></div></div></div>',1)),t("div",Bs,[t("div",qs,[t("div",Ws,[e[3]||(e[3]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Генератор отчетов"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",xs,[k(r,{onGenerateReport:a.handleReport},null,8,["onGenerateReport"])])])])])],64)}const Js=S(js,[["render",_s]]),Xs={methods:{goTo(l){this.$router.push({name:l})},handleReport(l){bootstrap.Modal.getInstance(document.getElementById("reportModal")).hide(),console.log("Отчёт сформирован:",l)},async fetchData(){bootstrap.Modal.getInstance(document.getElementById("newSaleModal")).hide()}}},Ks={class:"modal fade",id:"newSaleModal",tabindex:"-1"},Qs={class:"modal-dialog modal-fullscreen"},Ys={class:"modal-content"},Zs={class:"modal-body"},el={class:"modal fade",id:"reportModal",tabindex:"-1"},tl={class:"modal-dialog"},ol={class:"modal-content"},sl={class:"modal-body"};function ll(l,e,o,u,s,a){const r=N("SaleForm"),g=N("ReportGenerator");return n(),i(m,null,[t("button",{type:"button",onClick:e[0]||(e[0]=V=>a.goTo("SalePage")),class:"btn btn-primary p-3 mb-2 w-100"},"Профиль официального лица"),e[3]||(e[3]=t("div",{class:"btn-group-vertical w-100",role:"group","aria-label":"Вертикальное меню действий"},[t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#newSaleModal",class:"btn btn-outline-primary p-3"},"Список всех отчетов"),t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#reportModal",class:"btn btn-outline-primary p-3"},"Список заявок на мероприятия"),t("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#reportModal",class:"btn btn-outline-primary p-3"},"Список обращений граждан")],-1)),t("div",Ks,[t("div",Qs,[t("div",Ys,[e[1]||(e[1]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Создание задания"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",Zs,[k(r,{onSaved:a.fetchData},null,8,["onSaved"])])])])]),t("div",el,[t("div",tl,[t("div",ol,[e[2]||(e[2]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Генератор отчетов"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",sl,[k(g,{onGenerateReport:a.handleReport},null,8,["onGenerateReport"])])])])])],64)}const rl=S(Xs,[["render",ll]]),nl={key:0,class:"container-fluid p-3"},il={data(){return{userStore:I()}},computed:{tg(){return window.Telegram.WebApp},user(){return this.userStore.self||null}},methods:{}},bl=Object.assign(il,{__name:"MenuPage",setup(l){const{t:e}=_();return(o,u)=>o.user?(n(),i("div",nl,[o.user.role===0?(n(),U(vs,{key:0})):p("",!0),o.user.role===1?(n(),U(Js,{key:1})):p("",!0),o.user.role===2?(n(),U(rl,{key:2})):p("",!0),o.user.role===3?(n(),U(Y,{key:3})):p("",!0),o.user.role===4?(n(),U(Ps,{key:4})):p("",!0),o.user.base_role===4?(n(),U(Hs,{key:5})):p("",!0)])):p("",!0)}});export{bl as default};
